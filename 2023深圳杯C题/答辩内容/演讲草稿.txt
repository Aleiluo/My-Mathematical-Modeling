各位老师同学们大家好，我们组选择的是深圳杯的C题，小组成员是秦雨祥、马浩坤、康子杰。我们的论文题目是基于改进麻雀搜索优化DWA的无人机协同避障规划。

问题背景部分


问题假设部分
照着念


问题一的重述和分析部分：

问题重述：求先到无人机的最短耗时。
问题一的分析：做出猜想：无人机B先到达，路线时先走....，而无人机A躲避无人机B前进。对于无人机A的规划，有两种方法，一种是无人机A有一个固定策略，比如现在起点或者其他不会碰面的位置转圈等待，然后延切线轨迹飞向终点。另一种就是使用动态避障算法，比如DWA、人工势场法，但是这两个方法都是局部避障算法，通常会结合如A*，dij等全局最短路算法。但是本题，障碍物较为简单，直接使用局部避障算法就能得到很好的结果。

于是我们第一步证明出无人机B的最短路径。对于无人机A使用DWA动态窗口法进行局部避障。

问题一的具体部分：

证明页：
为了证明 只有一台无人机最短路线是B走一段切线，再走一段圆弧，最后再走一段切线。从AB两点各引一条切线到圆同侧，坐标轴被分为五个区域，对于每一个区域的证明的核心思想是三角形的两边之和大于第三边。

参数方程页：
得到了无人机B的参数方程分为4段，分别是第一条切线到圆弧再到第二条切线，后面的时间无人机B均在终点等候。

DWA算法介绍页:
DWA算法是一种局部避障的方法，算法的核心在于向前采样，该能够提前让无人机感知到周围的障碍物，并做出相应调整，具有计算量小, 反应迅速、可操作性强的优点。

流程图：
DWA算法流程图主要包括采样和步进两部分。采样的第一步是确定无人机的角速度范围，下一步在该范围内等距选取若干个离散角速度并计算各采样点，接着计算各采样点的加权标准化得分，得分最大者步进。

DWA采样具体介绍页：
Ω是一个角速度范围，这个范围的下界取两者最大值，上界取两者最小值，这个公式同时考虑了无人机的最大角速度和最大角加速度两个约束。本题并没有给出角加速度，这里设为100rad/s^2
w_i圈是等距选取的离散角速度，从公式中可以看出w_i必定包含0，这么设计是为了解决无人机直线飞行的情况。传统DWA在选取离散角速度时均为等距选取，并没有考虑这个问题。

从无人机到采样点可以看做是多个小直线段的叠加，每一个轨迹需要使用t_s / dt次这个公式。比如采样时长t_s = 10， 时间分辨率dt = 0.5时，就需要使用10 / 0.5 = 20次下面这个公式。
因为我们选取了n个角速度，对于每一个角速度我们都类似地计算采样点。


DWA采样点得分公式说明页：
之前提到了每个采样点得分是标准化得分加权和。(这里大概介绍一下三个得分的含义)
heading: 采样点处无人机的朝向得分
static:采样点到各个障碍物的得分
distance:采样点处到终点的得分

朝向得分介绍页：
朝向得分先计算采样点与终点之间的夹角，若采样点处无人机的朝向与该夹角的相差越小，heading得分越接近pi。这里考虑到采样点无人机的朝向并不在[-pi,pi]之间，所以使用三角函数sin,cos消除角度的周期性。
distance就是到终点距离得分，这里使用足够大的数M减去采样点到终点的距离实现指标正向化。

障碍物得分指标
障碍物得分分为两个部分，一是到圆的距离，二是到对方无人机视线，也就是到切线的距离。到圆的距离就是到圆心距减去圆的半径,到切线的距离是两个的较小者。要注意是，引切线的点不是无人机B当前时刻的位置，而是无人机B t_s秒后的点引的切线。因为对于无人机A的采样点已经是t_s秒后的点，无人机B引切线的点也要是t_s秒后的点。

避免无人机进入到圆内
无人机的采样点如果在圆内，这一条轨迹必然作废。然而采样点在圆外但是采样轨迹在圆内，只需判断当前轨迹的第一个点和最后一个点（也就是采样点）是否都在圆外。

终点说明：
无人机接近终点时需要减小向后采样时间t_s来避免采样点超过终点。采样点超过终点会引发朝向得分计算错误的问题，导致无人机围着终点转圈而不接近终点。所以使用终点的两个大小不同的圆形领域来控制采样时间t_s的变化。

结果展示页：
展示结果，说清楚结果

结果检验1
标准化得分：基本上可以看出转的圈数。
无人机A每一步的角速度表明角速度均没超过0.33rad/s。

结果检验2：
左图展示无人机到静态圆的距离，曲线均在红色虚线上方，说明无人机A没有撞上圆形障碍。
右图是无人机AB到原点的垂直距离，如果该距离大于500，说明无人机AB碰面。

问题二重述与分析：
问题重述：求后到达的无人机的最短耗时。
问题二分析：由问题一知，无人机B先到达，无人机A后到达，最关心的一个问题是无人机B怎么走，才能使无人机A走出最短路线。做一做综述：关于无人机B怎么走这个问题，有两种猜想：1是无人机B尽快接近圆，这样才能使得接近圆后切线的变化最快，才能更快地给无人机A让出空间。另一个猜想是和问题一走切线，让无人机以最快速度绕过障碍圆，以达到给无人机A让位置的目的。

于是我们下面的工作主要围绕两架无人机的路线探索展开。

我们第一步提出双DWA模型，问题一是无人机A单DWA的算法，问题二两架无人机都有DWA。
接着对于每一架无人机，都增加一个中间的目标点，实现对无人机位置更精确控制。
第三步，我们改进DWA的评价函数，将障碍物得分分为动态和静态，由不同权重控制。
在第四步中，因为不知道无人机的行驶路径，我们提出了一种估计方法。
然后使用麻雀算法优化双DWA的各个参数，得到一个较优解。
因为单次DWA的模拟线路较长，我们从公式上和程序上都做了优化。

双DWA流程图
简单介绍一下流程图

评价函数部分
简述一下

中间点的选取页：
对两架无人机都设置了一个中间目标点，中间目标点位于圆上，无人机先以中间目标点为终点，当接近靠近目标点时，自动切换到下一目标点。
选取中间目标点的目的在于更好地控制无人机的行走轨迹，中间目标点的选择可以让无人机一开始朝切线方向走，也可以朝圆心方向走，或者走其他的方向，有了这两个参数，麻雀算法可以更加方便的优化无人机的轨迹。

对方无人机采样点估计页：
不像第一题，有一架无人机走参数方程，那么可以求出t_s秒后的确切位置。问题二中，两架无人机均使用DWA算法，行动轨迹无法预测。现在一台无人机要计算各采样点的到切线的距离。要从另一台无人机t_s秒之后的位置引两条切线，这个位置的选取如下：先求对方无人机的所有采样点，然后选在圆外且离圆最近的采样点，引两条切线，再进行相关计算。

过渡语：
讲完动态的要说明朝向、终点、静态障碍物得分与第一问相同。

麻雀算法页
优化目标是使得后到达无人机的用时，也就是无人机A的耗时最小。

优化参数挨个说明...

性能改进
在问题一中，提到了计算一段轨迹要算t_s / dt次。若有n个轨迹就要计算n * t_s / dt次。DWA算法要步进上千次。所以轨迹计算公式的开销极大。这里我们使用通式由无人机当前位置直接得到了采样点的坐标，计算效率大幅提升。
    此外，我们的麻雀算法在matlab中使用了多线程技术，问题二的所有代码基本使用向量化运算，使得麻雀算法50多秒一次的迭代降至2秒。
    
问题二结果展示：
展示一下，对吧

问题二中较劣结果展示：
这些较劣结果是存在的，但是麻雀搜索在第一代就将其优化。

结果检验部分
角速度都没超

距离检验
和问题一一致，无人机A在飞行过程中没有违反约束。

问题三、四

第一页：简单地解释一下

第二页：

在1973.49前面无人机AB耗时相等，1973,49后无人机A飞行受到无人机B限制，无人机A耗时增加，无人机B仍然走最短路线。
无人机A的直线出现了轻微的波动，而无人机B的直线很光滑。这是因为，无人机A受到阻碍绕圈所以结果略有偏差，但是可以从拟合的直线看出大致的走势。

问题四：
问题四无人机B速度增加，无人机B的总耗时不断变小，且曲线光滑，无人机A和问题三一样因为绕圈出现了震荡情况。曲线的拐点在21.12m/s，无人机B的速度在此速度前，无人机A运动受阻，做绕圈运动，在此速度之后无人机A能够走最优路线，耗时为471.425;

问题五：
问题五我们以运动速度的快慢和距离的远近绘制了四象限图，无人机AB的耗时曲面如下图，作图展示了无人机A的耗时曲面，可见，无人机B的速度变化对无人机A耗时的影响比无人机B位置变化更剧烈。

具体改进
无人机采样角速度等距选取时，若角速度分辨率过大，无人机无法笔直走向终点。除了提高角速度分辨率，还可以使用中间密集，两侧稀疏的角速度选取办法。该方法好处在于以较少的采样点个数达到和减小角速度分辨率相同的性能。

对向无人机的飞行的路线可以使用预测算法或者更加保守和复杂的估计方法进行预测。

无人机向后探测时长主要受到无人机速度和周围障碍物影响，固定采样时长可能并不是最佳策略，根据无人机飞行速度和到障碍物距离调整的动态采样时长可能效果更好。
    


